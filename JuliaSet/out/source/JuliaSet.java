/* autogenerated by Processing revision 1297 on 2025-07-06 */
import processing.core.*;
import processing.data.*;
import processing.event.*;
import processing.opengl.*;

import java.util.HashMap;
import java.util.ArrayList;
import java.io.File;
import java.io.BufferedReader;
import java.io.PrintWriter;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.IOException;

public class JuliaSet extends PApplet {

PGraphics mbSet;
int maxIterations = 100;
float zoom = 1.3f;
float xOffset = -200;
float aspectRatio;
PFont font;

public void setup() {
    /* size commented out by preprocessor */;
    aspectRatio = PApplet.parseFloat(width) / PApplet.parseFloat(height);
    textAlign(RIGHT, TOP);
    fill(0, 255, 0);
    noStroke();
    font = createFont("Consolas", 32);
    textFont(font);

    mbSet = createGraphics(width, height, P2D);
}

public void draw() {
    float c_a = map(mouseX, 0, width , -2, 2);
    float c_b = map(mouseY, 0, height, 2, -2);
    createJuliaSet(c_a, c_b);
    image(mbSet, 0, 0);
    showC(c_a, c_b);
}

public void createJuliaSet(float c_a, float c_b) {
    mbSet.beginDraw();
    mbSet.loadPixels();
    
    for(int x = 0; x < width; x++) {
        for(int y = 0; y < height; y++) {
            float a = map(x, 0, width, -zoom*aspectRatio, zoom*aspectRatio);
            float b = map(y, 0, height, -zoom, zoom);

            int n;
            for(n = 0; n < maxIterations; n++) {
                float re = a*a - b*b;
                float im = 2*a*b;
                a = re + c_a;
                b = im + c_b;
                if (a*a + b*b > 4) break;
            }

            float bright = map(n, 0, maxIterations, 0, 255);
            if(n == maxIterations) bright = 0;

            mbSet.pixels[x + y*width] = color(bright);
        }
    }

    mbSet.updatePixels();
    mbSet.endDraw();
}

public void showC(float c_a, float c_b) {
    char c_aSign = c_a < 0 ? '-' : ' ';
    char c_bSign = c_b < 0 ? '-' : '+';
    String cText = String.format("c = %c %.8f %c %.8fi", c_aSign, abs(c_a), c_bSign, abs(c_b));
    text(cText, width, 0);
}


  public void settings() { fullScreen(P2D); }

  static public void main(String[] passedArgs) {
    String[] appletArgs = new String[] { "JuliaSet" };
    if (passedArgs != null) {
      PApplet.main(concat(appletArgs, passedArgs));
    } else {
      PApplet.main(appletArgs);
    }
  }
}
